(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(10),o=n.n(a),s=(n(15),n(16),n(17),n(8)),i=n(2),l=n(5),u=n(3),d=n(4),b=n.n(d),j="https://mate.academy/students-api";function f(e){return new Promise((function(t){setTimeout(t,e)}))}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),f(300).then((function(){return fetch(j+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var O,m=function(e){return p(e)},h=function(e,t){return p(e,"POST",t)},v=function(e,t){return p(e,"PATCH",t)},x=function(e){return p(e,"DELETE")},g=function(){var e=Object(l.a)(Object(i.a)().mark((function e(t){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(Object(i.a)().mark((function e(t){var n,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",h("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=n(0),k=function(e){var t=e.onLogin,n=Object(r.useState)(""),c=Object(u.a)(n,2),a=c[0],o=c[1],s=Object(r.useState)(""),d=Object(u.a)(s,2),j=d[0],f=d[1],p=Object(r.useState)(!1),O=Object(u.a)(p,2),m=O[0],h=O[1],v=Object(r.useState)(!1),x=Object(u.a)(v,2),k=x[0],E=x[1],N=Object(r.useState)(""),w=Object(u.a)(N,2),_=w[0],C=w[1],S=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(r.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){}}),[]);var D=function(){var e=Object(l.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(a);case 2:(t=e.sent)?S(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C(""),E(!0),e.prev=3,!m){e.next=9;break}return e.next=7,T({name:j,email:a}).then(S);case 7:e.next=11;break;case 9:return e.next=11,D();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),C("Something went wrtong");case 16:return e.prev=16,E(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(y.jsx)("h1",{className:"title is-3",children:m?"You need to register":"Log in to open todos"}),Object(y.jsxs)("div",{className:"field",children:[Object(y.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(y.jsxs)("div",{className:b()("control has-icons-left",{"is-loading":k}),children:[Object(y.jsx)("input",{type:"email",id:"user-email",className:b()("input",{"is-danger":!m&&_}),placeholder:"Enter your email",disabled:k||m,value:a,required:!0,onChange:function(e){return o(e.target.value)}}),Object(y.jsx)("span",{className:"icon is-small is-left",children:Object(y.jsx)("i",{className:"fas fa-envelope"})})]}),!m&&_&&Object(y.jsx)("p",{className:"help is-danger",children:_})]}),m&&Object(y.jsxs)("div",{className:"field",children:[Object(y.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(y.jsxs)("div",{className:b()("control has-icons-left",{"is-loading":k}),children:[Object(y.jsx)("input",{type:"text",id:"user-name",className:b()("input",{"is-danger":m&&_}),placeholder:"Enter your name",required:!0,minLength:4,disabled:k,value:j,onChange:function(e){return f(e.target.value)}}),Object(y.jsx)("span",{className:"icon is-small is-left",children:Object(y.jsx)("i",{className:"fas fa-user"})})]}),m&&_&&Object(y.jsx)("p",{className:"help is-danger",children:_})]}),Object(y.jsx)("div",{className:"field",children:Object(y.jsx)("button",{type:"submit",className:b()("button is-primary",{"is-loading":k}),children:m?"Register":"Login"})})]})},E=c.a.createContext(null),N=function(e){var t=e.children,n=Object(r.useState)(null),c=Object(u.a)(n,2),a=c[0],o=c[1];return a?Object(y.jsx)(E.Provider,{value:a,children:t}):Object(y.jsx)(k,{onLogin:o})};!function(e){e.LOAD="load",e.ADD="add",e.LENGTH="length",e.DELETE="delete",e.DELETEALL="deleteAll",e.UPDATE="update"}(O||(O={}));var w,_=function(e){var t=e.error,n=e.closeError,r="";switch(t){case O.LOAD:r="Unable to load todos";break;case O.ADD:r="Unable to add a todo";break;case O.LENGTH:r="Title can't be empty";break;case O.DELETE:r="Unable to delete a todo";break;case O.DELETEALL:r="Unable to delete todos";break;case O.UPDATE:r="Unable to update todo"}return Object(y.jsxs)("div",{"data-cy":"ErrorNotification",className:b()("notification","is-danger","is-light","has-text-weight-normal",{hiden:t}),children:[Object(y.jsx)("button",{"aria-label":"HideErrorButton","data-cy":"HideErrorButton",type:"button",className:"delete",onClick:n}),r]})},C=function(e){var t=e.todo,n=e.handleDeleteTodo,c=e.isEditing,a=e.setIsEditing,o=e.updateTodoOnServer,s=e.currTodo,i=e.setCurrTodo,l=Object(r.useState)(""),d=Object(u.a)(l,2),j=d[0],f=d[1],p=Object(r.useState)(0),O=Object(u.a)(p,2),m=O[0],h=O[1],v=Object(r.useRef)(null);Object(r.useEffect)((function(){v.current&&v.current.focus()}),[s]);var x=function(){t.title===j?a(!1):j?(o(t.id,{title:j}),a(!1)):n(t.id)};return Object(y.jsxs)("div",{"data-cy":"Todo",className:b()("todo",{completed:t.completed}),children:[Object(y.jsx)("label",{className:"todo__status-label",htmlFor:"status_handle",children:Object(y.jsx)("input",{id:"status_handle","data-cy":"TodoStatus",type:"checkbox",className:"todo__status",defaultChecked:t.completed,onClick:function(){return e=t.id,n=!t.completed,void o(e,{completed:n});var e,n}})}),c&&s===t.id?Object(y.jsx)("form",{onSubmit:function(e){e.preventDefault()},children:Object(y.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",ref:v,value:j,onKeyDown:function(e){!function(e){"Enter"===e.key&&x(),"Escape"===e.key&&a(!1)}(e)},onChange:function(e){f(e.target.value)},onBlur:x})}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return e=t.id,a(!0),i(e),void f(t.title);var e},children:t.title}),Object(y.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){h(t.id),n(t.id)},children:"\xd7"})]}),Object(y.jsxs)("div",{"data-cy":"TodoLoader",className:b()("modal overlay",{"is-active":t.id===m}),children:[Object(y.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(y.jsx)("div",{className:"loader"})]})]})},S=function(e){var t=e.todos,n=e.handleDeleteTodo,r=e.isEditing,c=e.setIsEditing,a=e.updateTodoOnServer,o=e.currTodo,s=e.setCurrTodo;return Object(y.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:t.map((function(e){return Object(y.jsx)(C,{todo:e,currTodo:o,setCurrTodo:s,isEditing:r,setIsEditing:c,handleDeleteTodo:n,updateTodoOnServer:a},e.id)}))})};!function(e){e.all="all",e.active="active",e.completed="completed"}(w||(w={}));var D=function(e){var t=e.todos,n=e.setFilterType,r=e.deleteTodos,c=t.filter((function(e){return!e.completed})).length,a=t.some((function(e){return e.completed}));return Object(y.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(y.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(c," items left")}),Object(y.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(y.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:b()("filter__link",{selected:w.all}),onClick:function(){return n(w.all)},children:"All"}),Object(y.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:b()("filter__link",{selected:w.active}),onClick:function(){return n(w.active)},children:"Active"}),Object(y.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:b()("filter__link",{selected:w.completed}),onClick:function(){return n(w.completed)},children:"Completed"})]}),Object(y.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",style:{visibility:a?"visible":"hidden"},onClick:r,children:"Clear completed"})]})},L=function(e){var t=e.todos,n=e.newTodo,c=e.isAdding,a=e.addNewTodo,o=e.setTodo,s=e.todoToAdd,i=e.handleChangeToggleAll,l=t.every((function(e){return!0===e.completed}));return Object(r.useEffect)((function(){n.current&&n.current.focus()}),[c]),Object(y.jsxs)("header",{className:"todoapp__header",children:[0!==t.length&&Object(y.jsx)("button",{"aria-label":"ToggleAllButton","data-cy":"ToggleAllButton",type:"button",className:b()("todoapp__toggle-all",{active:l}),onClick:i}),Object(y.jsx)("form",{onSubmit:function(e){e.preventDefault(),a()},children:Object(y.jsx)("input",{"data-cy":"NewTodoField",disabled:c,type:"text",ref:n,className:"todoapp__new-todo",placeholder:"What needs to be done?",value:s,onChange:function(e){return o(e.target.value)}})})]})},A=function(e){return x("/todos/".concat(String(e)))},F=function(e,t){return v("/todos/".concat(e),t)},I=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),o=Object(u.a)(a,2),d=o[0],b=o[1],j=Object(r.useState)(w.all),f=Object(u.a)(j,2),p=f[0],v=f[1],x=Object(r.useState)(!1),g=Object(u.a)(x,2),T=g[0],k=g[1],N=Object(r.useState)(""),C=Object(u.a)(N,2),I=C[0],U=C[1],B=Object(r.useState)(0),P=Object(u.a)(B,2),H=P[0],J=P[1],G=Object(r.useState)(!1),M=Object(u.a)(G,2),R=M[0],q=M[1],Y=Object(r.useContext)(E),K=Object(r.useRef)(null),W=n.filter((function(e){switch(p){case w.active:return!e.completed;case w.completed:return e.completed;default:return!0}})),z=Object(r.useMemo)((function(){return n.filter((function(e){return!e.completed}))}),[n,p]),Q=Object(r.useMemo)((function(){return n.filter((function(e){return e.completed}))}),[n,p]),V=Object(r.useCallback)(Object(l.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n=(null===Y||void 0===Y?void 0:Y.id)||0,m("/todos?userId=".concat(n));case 3:t=e.sent,c(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),b(O.LOAD);case 10:case"end":return e.stop()}var n}),e,null,[[0,7]])}))),[]);Object(r.useEffect)((function(){d&&setTimeout((function(){return b(null)}),3e3)}),[d]);var X=Q.length===n.length,Z=function(){var e=Object(l.a)(Object(i.a)().mark((function e(t,n){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===Y||void 0===Y||!Y.id){e.next=4;break}return e.next=4,F(t,n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),b(O.UPDATE);case 9:return e.prev=9,V(),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(t,n){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){K.current&&K.current.focus(),V()}),[]);var $=function(){var e=Object(l.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(!0),I.length){e.next=7;break}return b(O.LENGTH),setTimeout((function(){return b(null)}),3e3),U(""),k(!1),e.abrupt("return");case 7:if(!Y){e.next=18;break}return e.prev=8,e.next=11,n=I,r=Y.id,h("/todos",{title:n,userId:r,completed:!1});case 11:t=e.sent,c((function(e){return[].concat(Object(s.a)(e),[t])})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),b(O.ADD);case 18:U(""),k(!1);case 20:case"end":return e.stop()}var n,r}),e,null,[[8,15]])})));return function(){return e.apply(this,arguments)}}(),ee=Object(r.useCallback)(function(){var e=Object(l.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Y){e.next=10;break}return e.prev=1,e.next=4,A(t);case 4:c((function(e){return e.filter((function(e){return e.id!==t}))})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),b(O.DELETE);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),[Y]),te=function(){var e=Object(l.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(n.map(function(){var e=Object(l.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.completed){e.next=3;break}return e.next=3,A(t.id);case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:c((function(e){return e.filter((function(e){return!e.completed}))})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),b(O.DELETEALL);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),ne=Object(r.useCallback)((function(e){v(e)}),[]);return Object(y.jsxs)("div",{className:"todoapp",children:[Object(y.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(y.jsxs)("div",{className:"todoapp__content",children:[Object(y.jsx)(L,{todos:n,newTodo:K,isAdding:T,addNewTodo:function(){return $()},setTodo:U,todoToAdd:I,handleChangeToggleAll:function(){(X?Object(s.a)(Q):Object(s.a)(z)).forEach((function(e){return Z(e.id,{completed:!X})}))}}),n.length>0&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(S,{todos:W,handleDeleteTodo:ee,isEditing:R,setIsEditing:q,updateTodoOnServer:Z,currTodo:H,setCurrTodo:J}),Object(y.jsx)(D,{todos:n,setFilterType:ne,deleteTodos:te})]})]}),d&&Object(y.jsx)(_,{error:d,closeError:function(){return b(null)}})]})};o.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(N,{children:Object(y.jsx)(I,{})})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.02b806d8.chunk.js.map